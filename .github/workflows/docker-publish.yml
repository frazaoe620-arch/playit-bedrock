name: Bedrock + Playit (TESTE)

on:
  workflow_dispatch:

jobs:
  run-server:
    runs-on: ubuntu-latest
    steps:
      - name: Rodar Bedrock + Playit
        env:
          CHAVE: ${{ secrets.PLAYIT_SECRET }}
        run: |
          echo "Iniciando servidor..."

          docker run -d \
            --name bedrock \
            -e EULA=TRUE \
            -p 19132:19132/udp \
            -v bedrock_data:/data \
            itzg/minecraft-bedrock-server

          echo "Iniciando Playit..."

          docker run -d \
            --name playit \
            -e SECRET_KEY="$CHAVE" \
            ghcr.io/playit-cloud/playit-agent:0.16 --force-ipv4

          echo "Servidor rodando (vai cair quando Actions matar o job)..."

          # Mantém o workflow vivo por 6 horas (limite máximo)
          sleep 21600
